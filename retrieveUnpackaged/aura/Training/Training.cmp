<aura:component controller="TrainingController" implements="flexipage:availableForAllPageTypes,force:hasRecordId,force:hasSObjectName">														
    <aura:attribute name="pcRecordId" type="Id"/>
    <aura:attribute name="recordId" type="Id"/>
    <aura:attribute name="tempAttachId" type="string" default=""/>
    <aura:attribute name="nextAction" type="string" default="save"/>
    <aura:attribute name="maxTrainingRecords" type="Integer" default="3"/>
    <aura:attribute name="curTrainingRecordNum" type="Integer" default="1"/>
    <aura:attribute name="saveNext" type="string" Default="Save &amp; New"/>
    <aura:attribute name="savingTraining" type="boolean" default="false"/>
    <aura:attribute name="isNewRecord" type="boolean" default="false"/>
    <aura:attribute name="isNewPCRequest" type="boolean" default="false"/>
    <aura:attribute name="trainingForms" type="Forms__c[]"/>
    
	<aura:registerEvent name="trainingBackEvent" type="c:NavigationEvent"/>
    <aura:handler name="onSaveSuccess" event="force:recordSaveSuccess" action="{!c.handleTrngSaveSuccess}" />
    <aura:handler name="recordSave" event="force:recordSave" action="{!c.saveTraining}" />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <aura:attribute name="sessionID" type="string"/>
    <aura:attribute name="pageMode" type="string" default="showRecords"/>  
    
    <aura:attribute name="showLoadingSpinner" type="boolean" default="false" />
    <aura:attribute name="fileName" type="String" default="No File Selected.." />
    
    
    <p style="margin-bottom: 35px; font-size: 125%;">
        <a onclick="{!c.viewFormTypes}" style="color: black; font-family: Arial,Helvetica,sans-serif; text-decoration-line: underline;">Back to Form Types</a>
    </p>
	
    <!-- Display all user training records -->   
    <aura:if isTrue="{!v.pageMode == 'showRecords'}">
        <div style="">
    <table style="border: 1px solid black;">
    	<tr style="background-color: #0070d2; border: 1px solid black;">
        	<td colspan="5" style="color: white; padding: 5px; border: 1px solid lightgray;">
            	Training Records
            </td>
            <td colspan="1" style="color: black; padding: 5px; border: 1px solid lightgray;">
            	<button id="newform_1" name="NewTraining" onclick="{!c.newTraining}">New</button>
            </td>
        </tr>
        <tr style="background-color: white; border: 1px solid black;">
        	<td colspan="6" style="color: white; padding: 1px; border: 1px solid lightgray;">
            	&nbsp;
            </td>
        </tr>
        <tr style="background-color: #0070d2; border: 1px solid black;">
        	<td style="width: 10%; color: white; padding: 5px; border: 1px solid lightgray;">
            	
            </td>
            <td style="width: 30%; color: white; padding: 5px; border: 1px solid lightgray;">
            	Course Title
            </td>
            <td style="width: 20%;color: white; padding: 5px; border: 1px solid lightgray;">
            	Location
            </td>
            <td style="width: 10%;color: white; padding: 5px; border: 1px solid lightgray;">
            	Date
            </td>
            <td style="width: 5%;color: white; padding: 5px; border: 1px solid lightgray;">
            	CLPs
            </td>
            <td style="width: 5%;color: white; padding: 5px; border: 1px solid lightgray;">
                Pass/Fail*
            </td>
        </tr>
        <aura:iteration var="form" items="{!v.trainingForms}">
            <tr style="background-color: white; border: 1px solid lightgray;">
                <td style="color: black; padding: 5px; border: 1px solid lightgray; text-align: center;">
                	<button id="{!form.Id}" name="" onclick="{!c.editTraining}">Edit</button>
                </td>
                <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                	{!form.Course_Title__c}
                </td>
                <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                	{!form.Location__c}
                </td>
                <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                	{!form.Date__c}
                </td>
                <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                	{!form.CLP_s__c}
                </td>
                <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                	{!form.Pass_Fail__c}
                </td>
            </tr>
        </aura:iteration>
    </table>
    </div>
    </aura:if>
    <br/>
    <!--New Form Modal-->
    <aura:if isTrue="{!or(v.pageMode == 'editRecord', v.pageMode == 'newPurchaseCard')}">
      <div role="dialog" tabindex="-1" aria-labelledby="header99" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">
          <!--BOX HEADER-->
          <div class="slds-modal__header">
            <button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" onclick="{!c.cancelEditTraining}">
            X
            <span class="slds-assistive-text">Close</span>
            </button> 
            Training Record {!v.curTrainingRecordNum} Of {!v.maxTrainingRecords}
          </div>
          <!--BOX BODY-->
          <div class="slds-modal__content slds-p-around--medium">
             <div aura:id="editDiv" ><force:recordedit aura:id="editTrainingRec" recordId="{!v.recordId}"/></div>
              <lightning:input aura:id="fileId" onchange="{!c.handleFilesChange}" type="file" name="file" label="Upload Copy of Certificate" multiple="false" required="true"/>
              <div class="slds-text-body_small slds-text-color_error">{!v.fileName} </div>
              <aura:if isTrue="{!v.showLoadingSpinner}">
              <div class="slds-text-body_small slds-text-color_error">Uploading... 
                 <img src="/auraFW/resources/aura/images/spinner.gif" class="spinner-img" alt="Loading"/>'
              </div>
		   </aura:if>
          </div>
          <!--BOX FOOTER-->
          <div class="slds-modal__footer">
              <ui:button class="slds-button slds-button--neutral floatLeft" label="Cancel" press="{!c.cancelEditTraining}" />
              <ui:button aura:id="saveaction" class="slds-button slds-button--neutral" label="Save" press="{!c.saveTraining}" />              
             <aura:if isTrue="{!v.maxTrainingRecords > v.curTrainingRecordNum}">
                  <ui:button aura:id="savenext" class="slds-button slds-button--neutral" label="{!v.saveNext}" press="{!c.saveNextTraining}" />
             </aura:if>
          </div>
        </div>
      </div>
      <div class="slds-backdrop slds-backdrop--open"></div>
    </aura:if>
    <!--End New Form Modal-->
    <!-- Display Lightning Data Service errors -->
    <aura:if isTrue="{!not(empty(v.newTrainingError))}">
        <div class="recordError">
            {!v.recordError}</div>
    </aura:if>
</aura:component>