<aura:component controller="FormPageController" implements="flexipage:availableForAllPageTypes,force:hasRecordId,force:hasSObjectName">
	
	<!--Sharred Attributes -->
	<aura:attribute name="apiUserID" type="string"/>
    <aura:attribute name="backupFormId" type="string"/>
    <aura:attribute name="backUpFormName" type="string"/>
    <aura:attribute name="fileName" type="String" default="No File Selected.." />
    <aura:attribute name="hrefEmail" type="string"/>
    <aura:attribute name="hrefInfo" type="string"/>
    <aura:attribute name="message" type="string" />
    <aura:attribute name="pageStatus" type="string" default="viewFormTypes"/>
    <aura:attribute name="sessionID" type="string"/>
    <aura:attribute name="siteUserID" type="string"/>
    <aura:attribute name="trainingPageMode" type="string"/>
    <aura:attribute name="viewFormName" type="string"/>
    <aura:attribute name="formOption" type="string"/>

    <aura:attribute name="forceSelectFormOption" type="boolean" default="false"/>
    <aura:attribute name="isCopy" type="boolean" default="false"/>
    <aura:attribute name="isNew" type="boolean" default="false"/>
    <aura:attribute name="largeFile" type="boolean" default="false" />
    <aura:attribute name="onSubmit" type="boolean" default="false"/>
    <aura:attribute name="viewTheModal" type="boolean" default="false"/>


    <aura:attribute name="viewFormID" type="Id"/>

	<aura:attribute name="forms" type="RecordType[]"/>
	<aura:attribute name="mySavedForms" type="Forms__c[]"/>

	<aura:attribute name="FandP_forms" type="List"/>
    
    <aura:attribute name="newForm" type="Forms__c"/>

    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:handler name="onSaveSuccess" event="force:recordSaveSuccess" action="{!c.handleSaveSuccess}" />
    <aura:handler name="recordSave" event="force:recordSave" action="{!c.handleSave}" />

    <!-- Below unique to oarm and not related to any of the above -->
    <aura:attribute name="isOpen" type="boolean" default="false"/>
    <aura:attribute name="confirmIsOpen" type="boolean" default="false"/>
    <aura:attribute name="modalName" type="string"/>
    <aura:attribute name="authenticated" type="boolean" />
    <aura:attribute name="selectedFormId" type="Id"/>
    <aura:attribute name="selectedFormName" type="string"/>
    <aura:attribute name="oldForm" type="Forms__c"/>
    <aura:attribute name="approvalSuccess" type="string"/>
    <aura:attribute name="approved" type="boolean" default="false"/>
    <aura:attribute name="currentUser" type="Id"/>
    <aura:attribute name="newFormId" type="string"/>   
    <aura:attribute name="pcOptionPurchaseCard" type="string" default='New Purchase Card'/>
    <aura:attribute name="pcOptionConvenienceCheck" type="string" default='New Convenience Check'/>
    <aura:attribute name="isSaveFired" type="boolean" default="false"/>
    
    <aura:handler name="change" value="{!v.newForm}" action="{!c.openModal2}" />
    <aura:handler name="formOptionSelEvent" event="c:FormOptionSelectedEvent" action="{!c.handleFormSelEvent}"/>
    <aura:handler name="trainingBackEvent" event="c:NavigationEvent" action="{!c.handleTrainingBackEvent}"/>
    <!--tsherman 1.15.18-->
    <!--aura:handler name="onSaveSuccess" event="force:recordSaveSuccess" action="{!c.onSaveSuccessTraining}"/-->

    <!--Below unique to t2 sandbox and not related to the first group -->

    <aura:attribute name="theModal" type="Forms__c"/>
    <aura:attribute name="hasAttachments" type="boolean" default="false"/>
    <aura:attribute name="addAttachments" type="boolean" default="false"/>
    <aura:attribute name="attachList" type="Attachment[]"/>
    <aura:attribute name="saveAndClose" type="boolean" default="false"/>
    <aura:attribute name="showLoadingSpinner" type="boolean" default="false" />
    <aura:attribute name="fileUploadCmp" type="Aura.Component[]"/>
    <aura:attribute name="uploadFiles" type="Object[]"/>
    <aura:attribute name="fileList" type="ContentVersion[]"/>
    <lightning:spinner aura:id="mySpinner" alternativeText="Uploading Attachment" class="slds-hide slds-is-fixed"/>
    
    <aura:attribute name="isPurchase" type="boolean" default="false"/>


    <!-- Header This Section is the same in oarm and t2 except the 'c.viewMyTrainingForms' -->
    <p style="margin-bottom: 35px; font-size: 125%;">
        <aura:if isTrue="{!v.pageStatus == 'viewFormTypes'}">
            <a onclick="{!c.viewMyForms}" style="color: black; font-family: Arial,Helvetica,sans-serif; text-decoration-line: underline;">My Forms</a>
            <a href="{!'/ProfilePage?sid='+v.sessionID}" style="margin-left: 30px; color: black; font-family: Arial,Helvetica,sans-serif; text-decoration-line: underline;">Edit My Approvers</a>
		    <a onclick="{!c.viewMyTrainingForms}" style="margin-left: 30px;color: black; font-family: Arial,Helvetica,sans-serif; text-decoration-line: underline;">My Training</a>
        </aura:if>
        <aura:if isTrue="{!v.pageStatus == 'viewMyForms'}">
            <a onclick="{!c.viewFormTypes}" style="color: black; font-family: Arial,Helvetica,sans-serif; text-decoration-line: underline;">Back to Form Types</a>
        </aura:if>
    </p>
    <!--End Header-->

    <!--Message This section is the same in oarm and t2 -->
    <aura:if isTrue="{!and(v.message != '', v.message != null)}">
    	<div class="slds-page-header" role="banner" style="margin-bottom: 20px; margin-top: -20px; text-align: center;">
            <div class="slds-grid">
                <div class="slds-col">
                    <p class="slds-text-heading--label">{!v.message}</p>
                </div>
            </div>
        </div>
    </aura:if>    
    <!--End Message-->

    <!--View Form Types List-->
    <aura:if isTrue="{!v.pageStatus == 'viewFormTypes'}">
    <div style="">
    <table style="border: 1px solid black;">
    	<tr style="background-color: #0070d2; border: 1px solid black;">
        	<td colspan="3" style="color: white; padding: 5px; border: 1px solid lightgray;">
            	WORKFLOW FORMS BY NUMBER
            </td>
        </tr>
        <tr style="background-color: white; border: 1px solid black;">
        	<td colspan="3" style="color: white; padding: 1px; border: 1px solid lightgray;">
            	&nbsp;
            </td>
        </tr>
        <tr style="background-color: #0070d2; border: 1px solid black;">
        	<td style="width: 12%; color: white; padding: 5px; border: 1px solid lightgray;">
            	
            </td>
            <td style="width: 30%; color: white; padding: 5px; border: 1px solid lightgray;">
            	FORM NUMBER
            </td>
            <td style="color: white; padding: 5px; border: 1px solid lightgray;">
            	FORM NAME
            </td>
        </tr>
        <aura:iteration var="form" items="{!v.forms}">
            <tr style="background-color: white; border: 1px solid lightgray;">
                <td style="color: black; padding: 5px; border: 1px solid lightgray; text-align: center;">
                	<button id="{!form.Id}" name="{!form.Name}" onclick="{!c.createNewForm}">New Form</button>
                </td>
                <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                	{!form.Name}
                </td>
                <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                	{!form.Description}
                </td>
            </tr>
        </aura:iteration>
    </table>
    </div>
    </aura:if> 
    <!--End Form List-->
    <br/>
    <!--View Fill & Print Forms List-->
    <aura:if isTrue="{!v.pageStatus == 'viewFormTypes'}">
    <div style="">   
    <table style="border: 1px solid black;">
        <tr style="background-color: #0070d2; border: 1px solid black;">
            <td colspan="3" style="color: white; padding: 5px; border: 1px solid lightgray;">
                FILL &amp; PRINT FORMS BY NUMBER &nbsp; &nbsp; <img src="{!$Resource.PDFLogo}"></img>
            </td>
        </tr>
        <tr style="background-color: white; border: 1px solid black;">
            <td colspan="3" style="color: white; padding: 1px; border: 1px solid lightgray;">
                &nbsp;
            </td>
        </tr>
        <tr style="background-color: #0070d2; border: 1px solid black;">
            <td style="width: 12%; color: white; padding: 5px; border: 1px solid lightgray;">
                
            </td>
            <td style="width: 30%; color: white; padding: 5px; border: 1px solid lightgray;">
                FORM NUMBER
            </td>
            <td style="color: white; padding: 5px; border: 1px solid lightgray;">
                FORM NAME
            </td>
        </tr>
        <aura:iteration var="FPforms" items="{!v.FandP_forms}">  
            <tr style="background-color: white; border: 1px solid lightgray;">
                <td style="color: black; padding: 5px; border: 1px solid lightgray; text-align: center;">
                <a href="{!FPforms.File_Url__c}" target="_blank">
                    <button style="color: black;">Download</button>
                </a>  
                </td>
                <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                    {!FPforms.Label}
                </td>
                <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                    {!FPforms.Description__c}
                </td>
            </tr>
        </aura:iteration>
    </table>
        <br/><br/>
    </div>
    </aura:if> 
    <!--End Fill and Print Forms List-->

     <!--View My Forms List-->
    <aura:if isTrue="{!v.pageStatus == 'viewMyForms'}">
        <div style="">
            <table style="border: 1px solid lightgray;">
                <tr style="background-color: #0070d2; border: 1px solid lightgray;">
                    <td colspan="6" style="color: white; padding: 5px; border: 1px solid lightgray;">
                        MY FORMS
                    </td>
                </tr>
                <tr style="background-color: white; border: 1px solid lightgray;">
                    <td colspan="6" style="color: white; padding: 1px; border: 1px solid lightgray;">
                        &nbsp;
                    </td>
                </tr>
                <tr style="background-color: #0070d2; border: 1px solid lightgray;">
                    <td colspan="2" style="width: 20%; color: white; padding: 5px; border: 1px solid lightgray;">
                        
                    </td>
                    <td style="color: white; padding: 5px; border: 1px solid lightgray;">
                        FORM ID
                    </td>
                    <td style="color: white; padding: 5px; border: 1px solid lightgray;">
                        FORM NUMBER
                    </td>
                    <td style="color: white; padding: 5px; border: 1px solid lightgray;">
                        APPROVAL STEP
                    </td>
                    <td style="color: white; padding: 5px; border: 1px solid lightgray;">
                        CREATED DATE
                    </td>
                </tr>
                <aura:iteration var="form" items="{!v.mySavedForms}">
                    <tr style="background-color: white; border: 1px solid lightgray;">
                        <td style="color: black; padding: 5px; border: 1px solid lightgray; text-align: center;">
                        <button id="{!form.Id}" name="{!form.Form_Type_Name__c}" onclick="{!c.viewFormJS}">Open Form</button> 
                        </td>
                        <td style="color: black; padding: 5px; border: 1px solid lightgray; text-align: center;">
                        <button id="{!form.Id}" name="{!form.Form_Type_Name__c}" onclick="{!c.copyForm}">Copy Form</button>
                        </td>
                        <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                            {!form.Name}
                        </td>
                        <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                            {!form.Form_Type_Name__c}
                        </td>
                        <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                            <aura:if isTrue="{!form.Approval_Step__c == null}">
                                Not Submitted
                            </aura:if>
                            {!form.Approval_Step__c}
                        </td>
                        <td style="color: black; padding: 5px; border: 1px solid lightgray;">
                            <ui:outputDate value="{!form.CreatedDate}"/>
                        </td>
                    </tr>
                </aura:iteration>
            </table>
        </div>
    </aura:if> 
    <!--End View My Forms List-->

    <!-- From Production - James Lambert 1/11/18 -->

    <!--The Modal-->
    <aura:if isTrue="{!v.viewTheModal}">   
        <div role="dialog" tabindex="-1" aria-labelledby="header99" class="slds-modal slds-fade-in-open ">
        <div class="slds-modal__container">
          <!--BOX HEADER-->
          <div class="slds-modal__header">
              <aura:if isTrue="{!or(v.newForm.Approval_Step__c == null,v.newForm.Approval_Step__c == 'Rejected',v.newForm.Approval_Step__c == 'Approved') || v.newForm.SF_182_Prepare_For_checker__c || v.newForm.Approval_Step__c == 'Recalled'}">
                  <aura:if isTrue="{!v.isNew || v.isCopy}"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Cancel" onclick="{!c.confirmCancelCreationModal}">
                          X
                        <span class="slds-assistive-text">Cancel</span>
                        </button>
                      <aura:set attribute="else"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" onclick="{!c.confirmCloseModal}">
                          X
                        <span class="slds-assistive-text">Close</span>
                        </button></aura:set>
                    </aura:if>
                  <aura:set attribute="else"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" onclick="{!c.closeModal}">
                          X
                        <span class="slds-assistive-text">Close</span>
                        </button></aura:set>
              </aura:if>          
            <h2 id="header99" class="slds-text-heading--medium">
                Status:
                <aura:if isTrue="{!or(v.newForm.Approval_Step__c == null,v.newForm.Approval_Step__c == 'Recalled',v.newForm.Approval_Step__c == 'Rejected',v.newForm.Approval_Step__c == 'Approved') || v.newForm.SF_182_Prepare_For_checker__c}">
                    {!v.message}Not Submitted
                    <aura:set attribute="else">
                          Submitted &nbsp; | &nbsp; {!v.newForm.Approval_Step__c}
                    </aura:set>
                </aura:if>
                <a href="{!'/FormPrintableTypeOne?fID='+v.viewFormID+'&amp;sid='+v.sessionID}" target="_blank" style="float: right;">
                    <img src="{!$Resource.PDFLogo}"/>
                </a>
            </h2>   
              
              <h3>                    
                  <aura:if isTrue="{!and(v.viewFormName!='ORD-111',v.viewFormName!='SF-182')}"><br/>For help using {!v.viewFormName} please contact: <a href="{!v.hrefInfo}" target="_blank">{!v.hrefEmail}</a></aura:if>
                  <aura:if isTrue="{!v.viewFormName=='ORD-111'}"><br/>For instructions using {!v.viewFormName} please click here: <a href="{!v.hrefInfo}" target="_blank">{!v.hrefEmail}</a></aura:if>
                  <aura:if isTrue="{!v.viewFormName=='SF-182'}"><br/>For help using {!v.viewFormName} please contact your Training Officer.<br/>Employees will find their Training Officer <a href="{!v.hrefInfo}" target="_blank">{!v.hrefEmail}</a></aura:if>            
              </h3> 
              
          </div>
          <!--BOX BODY-->
          <div class="slds-modal__content slds-p-around--medium" >
              <aura:if isTrue="{!or(v.newForm.Approval_Step__c == null,v.newForm.Approval_Step__c == 'Rejected',v.newForm.Approval_Step__c == 'Approved') || v.newForm.SF_182_Prepare_For_checker__c || v.newForm.Approval_Step__c == 'Recalled'}">
                 <div aura:id="anchor">
                  {!v.theModal}
                 </div>    
                  <aura:set attribute="else">
                      <force:recordview aura:id="view" recordId="{!v.viewFormID}" />
                  </aura:set>
              </aura:if>
          </div>
          <!--BOX FOOTER-->
          <div class="slds-modal__footer">
            <!--attachments list-->
              <aura:if isTrue="{!v.hasAttachments}">
                <table style="border: 1px solid lightgray;">
                    <col width="1"/>
                    <col width="250"/>
                    <col width="70"/>
                    <tr style="background-color: #0070d2; border: 1px solid lightgray;">         
                        <td colspan="5" style="color: white; padding: 5px 5px 5px 15px; border: 1px solid lightgray;">
                            Attachments  
                        </td>
                    </tr>
                    <tr style="background-color: white; border: 1px solid lightgray;">
                        <td style="color: white; border: 0px solid white;">                           
                        </td>
                        <td style="color: black; text-shadow: 0px 0px 0px #000000; padding: 3px 1px 1px 10px; border: 1px solid lightgray; text-align: left;">
                            FILE NAME
                        </td>
                        <td style="color: black; text-shadow: 0px 0px 0px #000000; padding: 1px; border: 1px solid lightgray; text-align: center;">
                            DATE ADDED
                        </td>
                    </tr>
                    <aura:iteration var="attach" items="{!v.attachList}">
                      <tr style="background-color: white; border: 1px solid lightgray;">
                        <td style="color: black; border: 0px solid #0070d2; text-align: center;">
                            <a href="{!'/servlet/servlet.FileDownload?file='+attach.Id}" target="_blank">
                                <button style="color: black;">View</button>
                            </a>  
                          <div class="divider"/>
                            <aura:if isTrue="{!or(v.newForm.Approval_Step__c == null,v.newForm.Approval_Step__c == 'Rejected',v.newForm.Approval_Step__c == 'Approved') || v.newForm.SF_182_Prepare_For_checker__c || v.newForm.Approval_Step__c == 'Recalled'}">
                            <button id="{!attach.Id}" onclick="{!c.deleteAttachment}">Del</button>
                            </aura:if>
                        </td>
                        <td style="color: black; padding: 1px 1px 1px 5px; border: 1px solid lightgray; text-align: left;">
                            {!attach.Name}
                        </td>
                        <td style="color: black; padding: 1px 1px 1px 5px; border: 0px solid #0070d2; text-align: center;">                         
                           <ui:outputDateTime timezone="America/New_York" value="{!attach.CreatedDate}"/>
                        </td>
                      </tr>
                    </aura:iteration>
                    <aura:iteration var="file" items="{!v.fileList}">
                      <tr style="background-color: white; border: 1px solid lightgray;">
                        <td style="color: black; border: 0px solid #0070d2; text-align: center;">
                            <a href="{!'/sfc/servlet.shepherd/version/download/'+file.Id}" target="_blank">
                     <!--           <button style="color: black;">View</button>     -->
                                <button style="color: black;">Download</button>
                            </a>  
                    <!--      <div class="divider"/>
                            <aura:if isTrue="{!or(v.newForm.Approval_Step__c == null,v.newForm.Approval_Step__c == 'Rejected',v.newForm.Approval_Step__c == 'Approved') || v.newForm.SF_182_Prepare_For_checker__c || v.newForm.Approval_Step__c == 'Recalled'}">
                            <button id="{!file.Id}" onclick="{!c.deleteAttachment}">Del</button>
                            </aura:if>       -->
                        </td>
                        <td style="color: black; padding: 1px 1px 1px 5px; border: 1px solid lightgray; text-align: left;">
                            {!file.Title}
                        </td>
                        <td style="color: black; padding: 1px 1px 1px 5px; border: 0px solid #0070d2; text-align: center;">                         
                           <ui:outputDateTime timezone="America/New_York" value="{!file.CreatedDate}"/>
                        </td>
                      </tr>
                    </aura:iteration>                    
                </table> 
                  <br/>
              </aura:if>
            <!--end attachments list-->  
              
            <!--add attachments-->
              <aura:if isTrue="{!and(v.addAttachments, or(v.newForm.Approval_Step__c == null,v.newForm.Approval_Step__c == 'Rejected',v.newForm.Approval_Step__c == 'Approved') || v.newForm.SF_182_Prepare_For_checker__c || v.newForm.Approval_Step__c == 'Recalled')}">
                <div align="left">
                    {!v.fileUploadCmp}   
                           <div class="slds-text-body_small slds-text-color_error">
                               <aura:unescapedHtml value="{!v.fileName}" />  <aura:if isTrue="{!v.largeFile}"><a href="{!'/FileUpload?sid='+v.sessionID+'&amp;formID='+v.viewFormID}" target="_blank" onclick="{!c.hideAttachments}" style="color: black; text-decoration-line: underline;"> Large File Upload</a>
                        <br/></aura:if>
                           </div>
                         
                         <!--use aura:if for show-hide the loading spinner image--> 
                           <aura:if isTrue="{!v.showLoadingSpinner}">
                              <div class="slds-text-body_small slds-text-color_error">Uploading... 
                                 <img src="/auraFW/resources/aura/images/spinner.gif" class="spinner-img" alt="Loading"/>
                              </div>
                           </aura:if>              
                        <br/>
                </div>
             </aura:if>
            <!--end add attachments-->

              <aura:if isTrue="{!or(v.newForm.Approval_Step__c == null,v.newForm.Approval_Step__c == 'Rejected',v.newForm.Approval_Step__c == 'Approved') || v.newForm.SF_182_Prepare_For_checker__c || v.newForm.Approval_Step__c == 'Recalled'}">
                  <aura:if isTrue="{!v.isNew || v.isCopy}"><ui:button class="slds-button slds-button--neutral floatLeft" label="Cancel" press="{!c.confirmCancelCreationModal}" />
                    <aura:set attribute="else"><ui:button class="slds-button slds-button--neutral floatLeft" label="Close" press="{!c.confirmCloseModal}" /></aura:set>
                  </aura:if>  
                  <aura:if isTrue="{!and(v.isNew == false, v.isCopy == false)}"><ui:button class="slds-button slds-button_destructive floatLeft" label="Delete" press="{!c.confirmFormDelete}" /></aura:if> 
                  <aura:if isTrue="{!v.isNew || v.isCopy}">
                    <ui:button class="slds-button slds-button--neutral" label="Save to Enable Attachments" press="{!c.enableAttachments}" />            
                  <aura:set attribute="else">
                    <aura:if isTrue="{!or(v.hasAttachments, v.addAttachments)}"><ui:button class="slds-button slds-button--neutral" label="Hide Attachments" press="{!c.hideAttachments}" /></aura:if>
                    <aura:if isTrue="{!and(v.hasAttachments==false, v.addAttachments==false)}"><ui:button class="slds-button slds-button--neutral" label="Show/Add Attachments" press="{!c.showAttachments}" /></aura:if> 
                      </aura:set></aura:if>
                  <ui:button class="slds-button slds-button--neutral" label="Save" press="{!c.saveStay}" />
                  <ui:button class="slds-button slds-button_success" label="Submit" press="{!c.confirmSubmit}" /> 
                <aura:set attribute="else"><ui:button class="slds-button slds-button--neutral floatLeft" label="Close" press="{!c.closeModal}" />
                  <aura:if isTrue="{!or(v.hasAttachments, v.addAttachments)}"><ui:button class="slds-button slds-button--neutral" label="Hide Attachments" press="{!c.hideAttachments}" /></aura:if>
                  <aura:if isTrue="{!and(v.hasAttachments==false, v.addAttachments==false)}"><ui:button class="slds-button slds-button--neutral" label="Show Attachments" press="{!c.showAttachments}" /></aura:if> 
                </aura:set>
              </aura:if>
          </div>
        </div>
      </div>
      <div class="slds-backdrop slds-backdrop--open"></div>
    </aura:if>
    <!--End The Modal-->

    <!--New Form Modal-->
    <aura:if isTrue="{!and(v.isOpen, or(v.newForm.Approval_Step__c == null, v.newForm.Approval_Step__c == 'Rejected', v.newForm.Approval_Step__c == 'Recalled'))}">
      <div  id="newFrmDiv" role="dialog" tabindex="-1" aria-labelledby="header99" class="slds-modal slds-fade-in-open ">
        <div class="slds-modal__container">
          <!--BOX HEADER-->
          <div class="slds-modal__header">
            <button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" onclick="{!c.cancelCreationModalB}">
            X
            <span class="slds-assistive-text">Close</span>
            </button>
            <h2 id="header99" class="slds-text-heading--medium">
                Status: Not Saved {!v.message}
            </h2>
              
              <h3>                    
                  <br/>For help using {!v.selectedFormName} please contact: <a href="{!v.hrefInfo}" target="_blank">{!v.hrefEmail}</a>
              </h3>  
            
            <div aura:id="div1"></div>
          </div>
          <!--BOX BODY-->
          <div class="slds-modal__content slds-p-around--medium">
              <div id="formIntro"></div>
              <force:recordedit aura:id="edit" recordId="{!v.newForm.Id}" />
              <!--<force:recordData aura:id="recordHandler"
                                mode="edit"
                                targetRecord="{!v.newForm}"
                                recordId="{!v.newForm.Id}"/>-->
          </div>
          <!--BOX FOOTER-->
          <div class="slds-modal__footer">
              <ui:button class="slds-button slds-button--neutral floatLeft" label="Cancel" press="{!c.cancelCreationModalB}" />
              <aura:if isTrue="{!or(v.formOption == v.pcOptionPurchaseCard, v.formOption == v.pcOptionConvenienceCheck)}">
                  <!--ui:button class="slds-button slds-button neutral" label="NextA" press="{!c.addTrainingRecords}" /--> 
                  <ui:button class="slds-button slds-button--neutral" label="Next" press="{!c.saveOnly}" />
                  <aura:set attribute="else">
                      <ui:button class="slds-button slds-button--neutral" label="Save" press="{!c.saveOnly}" />
                      
                     <!--<ui:button class="slds-button slds-button_success" label="Submit" press="{!c.saveAndSubmitB}" />--> 
                      <ui:button class="slds-button slds-button_success" label="Submit" press="{!c.confirmSubmitB}" />
                  </aura:set>
              </aura:if>                
          </div>
        </div>
      </div>
      <div class="slds-backdrop slds-backdrop--open"></div>
    </aura:if>
    <!--End New Form Modal-->

    <!--Combined Modal-->
    <aura:if isTrue="{!v.modalName == 'viewForm'}">   
        <div role="dialog" tabindex="-1" aria-labelledby="header99" class="slds-modal slds-fade-in-open ">
        <div class="slds-modal__container">
          <!--BOX HEADER-->
          <div class="slds-modal__header">
            <button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" onclick="{!c.closeModal}">
            X
            <span class="slds-assistive-text">Close</span>
            </button>
            <h2 id="header99" class="slds-text-heading--medium">
                Status:  
                <aura:if isTrue="{!or(v.oldForm.Approval_Step__c == null,v.oldForm.Approval_Step__c == 'Rejected', v.oldForm.Approval_Step__c == 'Recalled', v.oldForm.Approval_Step__c == 'Approved')}">
                    Not Submitted
                    <aura:set attribute="else">
                          Submitted &nbsp;&nbsp; | &nbsp;&nbsp; {!v.oldForm.Approval_Step__c}
                    </aura:set>
                </aura:if>
                <a href="{!'/FormPrintableTypeOne?fID='+v.viewFormID+'&amp;sid='+v.sessionID}" target="_blank" style="float: right;">
                    <img src="{!$Resource.PDFLogo}"/>
                </a>
            </h2>   
              
              <h3>                    
                  <br/>For help using {!v.selectedFormName} please contact: <a href="{!v.hrefInfo}" target="_blank">{!v.hrefEmail}</a>
              </h3>
              
          </div>
          <!--BOX BODY-->
          <div class="slds-modal__content slds-p-around--medium">
              <aura:if isTrue="{!or(v.oldForm.Approval_Step__c == null,v.oldForm.Approval_Step__c == 'Rejected', v.oldForm.Approval_Step__c == 'Recalled', v.oldForm.Approval_Step__c == 'Approved')}">
                  <force:recordEdit aura:id="edit" recordId="{!v.viewFormID}" />
                  <aura:set attribute="else">
                      <force:recordview aura:id="view" recordId="{!v.viewFormID}" />
                  </aura:set>
              </aura:if>
          </div>
          <!--BOX FOOTER-->
          <div class="slds-modal__footer">
              <ui:button class="slds-button slds-button--neutral floatLeft" label="Cancel" press="{!c.closeModal}" />  
              <aura:if isTrue="{!or(v.oldForm.Approval_Step__c == null, v.oldForm.Approval_Step__c == 'Rejected', v.oldForm.Approval_Step__c == 'Recalled', v.oldForm.Approval_Step__c == 'Approved')}">
              <!--    <ui:button class="slds-button slds-button_destructive floatLeft" label="Delete" press="{!c.deleteFormJS}" />   -->
                  <ui:button class="slds-button slds-button_destructive floatLeft" label="Delete" press="{!c.confirmDelete}" />
                  <ui:button class="slds-button slds-button--neutral" label="Save" press="{!c.saveOnly}" />
             <!--     <ui:button class="slds-button slds-button_success" label="Submit" press="{!c.saveAndSubmit}" />  -->
                  <ui:button class="slds-button slds-button_success" label="Submit" press="{!c.confirmSubmitB}" />
              </aura:if>
          </div>
        </div>
      </div>
      <div class="slds-backdrop slds-backdrop--open"></div>
    </aura:if>
    <!--End Combined Modal-->
    <!-- Show options View -->
    
    <aura:if isTrue="{!v.forceSelectFormOption}">
        <div class="slds-modal slds-fade-in-open">
          <div class="slds-modal__container">
            <div class="slds-modal__content slds-p-around--medium">
               <div>
                   <c:FormOptions formTypeId="{!v.backupFormId}"></c:FormOptions>
               </div>
            </div>
          </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
    </aura:if>
    
    <!-- Training Records Component -->
    <aura:if isTrue="{!v.pageStatus == 'viewMyTrainings'}">
        <div>
            <c:Training sessionID="{!v.sessionID}" pageMode="{!v.trainingPageMode}" pcRecordId="{!v.newFormId}"></c:Training>
            </div>
    </aura:if>    


</aura:component>